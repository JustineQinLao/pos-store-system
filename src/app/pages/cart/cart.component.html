<div class="cart-container">
  <!-- Header -->
  <div class="cart-header">
    <h1>Shopping Cart</h1>
    <button (click)="continueShopping()" class="btn-secondary">
      ← Continue Shopping
    </button>
  </div>

  <!-- Empty Cart State -->
  <div *ngIf="cart.items.length === 0" class="empty-cart">
    <svg class="empty-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z" />
    </svg>
    <h2>Your cart is empty</h2>
    <p>Add some products to get started!</p>
    <button (click)="continueShopping()" class="btn-primary">Browse Products</button>
  </div>

  <!-- Cart Items -->
  <div *ngIf="cart.items.length > 0" class="cart-content">
    <div class="cart-items">
      <div *ngFor="let item of cart.items; let i = index" class="cart-item">
        <div class="item-details">
          <h3>{{ item.product.name }}</h3>
          <p class="item-variant" *ngIf="getVariantName(item)">{{ getVariantName(item) }}</p>
          <p class="item-addons" *ngIf="getAddonsText(item)">Add-ons: {{ getAddonsText(item) }}</p>
          <p class="item-price">${{ item.product.base_price | number:'1.2-2' }} each</p>
        </div>

        <div class="item-actions">
          <div class="quantity-control">
            <button (click)="updateQuantity(i, item.quantity - 1)" [disabled]="item.quantity <= 1">-</button>
            <span>{{ item.quantity }}</span>
            <button (click)="updateQuantity(i, item.quantity + 1)">+</button>
          </div>
          
          <div class="item-total">
            <strong>${{ getItemTotal(item) | number:'1.2-2' }}</strong>
          </div>

          <button (click)="removeItem(i)" class="btn-remove">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
            </svg>
          </button>
        </div>
      </div>
    </div>

    <!-- Cart Summary -->
    <div class="cart-summary">
      <h2>Order Summary</h2>
      
      <div class="summary-row">
        <span>Subtotal ({{ cart.itemCount }} items)</span>
        <span>${{ cart.total | number:'1.2-2' }}</span>
      </div>

      <div class="summary-row">
        <span>Tax (10%)</span>
        <span>${{ getTaxAmount() | number:'1.2-2' }}</span>
      </div>

      <div class="summary-divider"></div>

      <div class="summary-row total">
        <span>Total</span>
        <span>${{ getGrandTotal() | number:'1.2-2' }}</span>
      </div>

      <button (click)="generateQRCode()" class="btn-checkout" [disabled]="loading">
        <span *ngIf="!loading">Generate QR Code for Checkout</span>
        <span *ngIf="loading">Generating...</span>
      </button>

      <button (click)="clearCart()" class="btn-clear">Clear Cart</button>
    </div>
  </div>

  <!-- QR Code Modal -->
  <div *ngIf="showQRCode" class="qr-modal" (click)="closeQRCode()">
    <div class="qr-modal-content" (click)="$event.stopPropagation()">
      <div class="qr-header">
        <h2>Checkout QR Code</h2>
        <button (click)="closeQRCode()" class="btn-close">×</button>
      </div>

      <div class="qr-body">
        <p class="qr-instructions">Show this QR code to the cashier to complete your purchase</p>
        
        <div class="qr-code-display">
          <img [src]="qrCodeUrl" alt="Checkout QR Code" />
        </div>

        <div class="qr-details">
          <div class="detail-row">
            <span>Items:</span>
            <strong>{{ cart.itemCount }}</strong>
          </div>
          <div class="detail-row">
            <span>Total Amount:</span>
            <strong>${{ getGrandTotal() | number:'1.2-2' }}</strong>
          </div>
        </div>

        <p class="qr-note">
          <svg class="info-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
          This QR code is encrypted and secure. It contains your cart information for the cashier to process your payment.
        </p>
      </div>

      <div class="qr-footer">
        <button (click)="closeQRCode()" class="btn-primary">Close</button>
      </div>
    </div>
  </div>
</div>
